"0","#========================================================="
"0","#get PIT tag survival/age data"
"0","#========================================================="
"0","PIT<-read_csv(""data/Columbia_Steelhead_SAR_DART_11_1_2021.csv"")%>%"
"0","  dplyr::rename(OutmigrationYear=year)%>%"
"0","  mutate(Year=OutmigrationYear+1)%>%"
"0","  filter(Pop==""SNA"")"
"1","[1m[1mRows: [1m[22m[34m[34m42[34m[39m [1m[1mColumns: [1m[22m[34m[34m5[34m[39m
"
"1","[36m--[39m [1m[1mColumn specification[1m[22m [36m---------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (1): Pop
[32mdbl[39m (4): year, juvCount, ocean1Count, ocean2Count
"
"1","
[36mi[39m Use [38;5;251m[48;5;235m[38;5;251m[48;5;235m`spec()`[48;5;235m[38;5;251m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;251m[48;5;235m[38;5;251m[48;5;235m`show_col_types = FALSE`[48;5;235m[38;5;251m[49m[39m to quiet this message.
"
"0","SAR1<-data.frame(SAR1=gam(cbind(ocean1Count,juvCount-ocean1Count)~s(OutmigrationYear,k=(dim(PIT)[1])),family=binomial,data=PIT)$fitted)"
"0",""
"0","PIT<-PIT%>%"
"0","  bind_cols(SAR1)"
"0",""
"0","#========================================================="
"0","#get NPGO data"
"0","#========================================================="
"0","NPGO<-read_table(""http://www.o3d.org/npgo/npgo.php"",skip=29,col_names=F,comment=""#"")%>%"
"0","  filter(!is.na(X2))%>%"
"0","  dplyr::rename(Year=X1,Month=X2,NPGO=X3)%>%"
"0","  mutate(Year=as.numeric(Year))%>%"
"0","  group_by(Year)%>%"
"0","  add_tally()%>%"
"0","  filter(!Month>6)%>% #use only spring (Jan-June) NPGO"
"0","  #filter(!n < 12)%>% #use only complete years"
"0","  group_by(Year)%>%"
"0","  dplyr::summarise(NPGO=mean(NPGO))"
"1","
[36m--[39m [1m[1mColumn specification[1m[22m [36m---------------------------------------------------------------------------------[39m
cols(
  X1 = [31mcol_character()[39m,
  X2 = [32mcol_double()[39m,
  X3 = [32mcol_double()[39m
)

"
"2","Warning:"
"2"," 3 parsing failures.
row col  expected    actual                               file
859  -- 3 columns 1 columns 'http://www.o3d.org/npgo/npgo.php'
860  -- 3 columns 1 columns 'http://www.o3d.org/npgo/npgo.php'
861  -- 3 columns 1 columns 'http://www.o3d.org/npgo/npgo.php'

"
"0","#========================================================="
"0","#get NOAA indicator data, wrangle into usable format, plot"
"0","#========================================================="
"0","#indicators<-read_csv(""https://media.fisheries.noaa.gov/2021-04/Stoplight%20csv.csv?null"",skip=1)%>%"
"0","# indicators<-read_csv(""data/Stoplight csv.csv"",skip=1)%>%"
"0","#   filter(!is.na(`Ecosystem Indicators`))%>%"
"0","#   pivot_longer(names_to = ""Year"","
"0","#                 cols=c(starts_with(""1""),starts_with(""2"")),"
"0","#                 values_to = ""value"")%>%"
"0","#   pivot_wider(names_from=`Ecosystem Indicators`,values_from=value)%>%"
"0","#   mutate(Year=as.numeric(Year))"
"0",""
"0","# plotdat<-indicators%>%pivot_longer(names_to = ""indicators"", cols = colnames(indicators)[colnames(indicators)!=""Year""])"
"0","# ggplot(plotdat,aes(x=value,color=indicators))+"
"0","#   geom_density()+"
"0","#   facet_wrap(~indicators,scales=""free"")+"
"0","#   theme(legend.position = ""none"")"
"0",""
"0","#=============================================================="
"0","# get NOAA sst data directly from Buoys (takes a while to run)"
"0","#=============================================================="
"0","# buoylist<-c(46229, 46211, 46041, 46029, 46050, 46097, 46098)"
"0","# years<-c(1980:2021)"
"0","# buoy_stations()%>%filter(lat > 44 & lat < 52 & lon > -130 & lon < -120)"
"0","# buoydat<-getbuoydata(buoylist = buoylist,years=years)"
"0","# write.csv(dat,""SST.csv"",row.names = F)"
"0",""
"0","#==================="
"0","#Plot Buoy SST data"
"0","#===================="
"0","# buoydat<-buoydat%>%"
"0","#   filter(!is.na(buoyid) & !is.na(meanSST))%>%"
"0","#   group_by(buoyid,month)%>%"
"0","#   mutate(gmeanSST=mean(meanSST),resid=meanSST-gmeanSST)"
"0","#   "
"0","# "
"0","# ggplot(buoydat,aes(x=month,y=resid,group=factor(buoyid),color=factor(buoyid)))+"
"0","#   geom_hline(yintercept=0,linetype=""dashed"")+"
"0","#   scale_color_brewer(palette = ""Spectral"")+"
"0","#   geom_line()+"
"0","# facet_wrap(~factor(year))"
"0",""
"0",""
"0","#==========================================================================================================="
"0","#Get ERSST data: get_ersst_v5_data takes A LONG TIME (1 hr) vs. get_ersst_v5_data_V2 which is much quicker!"
"0","#==========================================================================================================="
"0","#dat<-get_ersst_v5_data(years=years,data.dir=getwd(),latrange=c(44,52),lonrange=c(-130,-120))"
"0","# data.dir<-""C:/Users/buehrtwb/OneDrive - Washington State Executive Branch Agencies/Documents"""
"0","# sstdat<-get_ersst_v5_data_V2(years=c(1980:2021),data.dir=data.dir ,ncfilename=""SSTv5.nc"",latrange=c(44,50),lonrange=c(-125,-120))"
"0","# "
"0","# sstdat<-sstdat%>%"
"0","#   mutate(sstdiff=c(NA,diff(resid)))"
"0","# "
"0","# #================"
"0","# #Plot ERSST data"
"0","# #================"
"0","# ggplot(sstdat,aes(x=factor(month),y=meanSST,group=year))+"
"0","#   geom_hline(yintercept=0,linetype=""dashed"")+"
"0","#   scale_color_brewer(palette = ""Spectral"")+"
"0","#   geom_line()+"
"0","#   facet_wrap(~factor(year))"
"0","# "
"0","# ggplot(sstdat,aes(x=factor(month),y=resid,group=year))+"
"0","#   geom_hline(yintercept=0,linetype=""dashed"")+"
"0","#   scale_color_brewer(palette = ""Spectral"")+"
"0","#   geom_line()+"
"0","#   facet_wrap(~factor(year))"
"0","# "
"0","# ggplot(sstdat,aes(x=factor(month),y=sstdiff,group=year))+"
"0","#   geom_hline(yintercept=0,linetype=""dashed"")+"
"0","#   scale_color_brewer(palette = ""Spectral"")+"
"0","#   geom_line()+"
"0","#   facet_wrap(~factor(year))"
"0","# "
"0","# ssta<-sstdat%>%"
"0","#   dplyr::select(year,month,resid)%>%"
"0","#   mutate(month = paste0(""m_"",month))%>%"
"0","#   rename(Year = year)%>%"
"0","#   pivot_wider(names_from = month,values_from = resid)"
"0","# "
"0","# pcdat<-ssta%>%"
"0","#   ungroup()%>%"
"0","#   filter(Year<2021)%>%"
"0","#   column_to_rownames(var=""Year"")"
"0","# mod<-prcomp(pcdat"
"0","#             )"
"0","# autoplot(mod,data=ssta%>%filter(Year<2021)%>%column_to_rownames(var=""Year""),"
"0","#          x=1,"
"0","#          y=3,"
"0","#          label = TRUE, "
"0","#          label.size = 3,"
"0","#          shape=F)"
